---
// src/pages/teams/[id].astro
import Layout from '../../layouts/Layout.astro';
import teams from '../../data/teams.json';
import drivers from '../../data/drivers.json';

export function getStaticPaths() {
  return teams.map((team) => ({
    params: { id: team.id },
    props: { team },
  }));
}

const { team } = Astro.props;

// Filter the drivers list to find the drivers for this specific team
const teamDrivers = drivers.filter(driver => driver.team === team.name);
---

<Layout title={`${team.name} | AFO Team Profile`}>
  <main class="max-w-7xl mx-auto px-4 py-20">
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center mb-24">
      <div>
        <div class="flex items-center gap-4 mb-6">
          <div class="h-1.5 w-12" style={`background-color: ${team.color}`}></div>
          <span class="text-zinc-500 font-bold uppercase tracking-[0.3em] text-sm">Official Constructor</span>
        </div>
        
        <h1 class="text-7xl md:text-8xl font-black italic uppercase leading-none mb-8 text-white">
          {team.name}
        </h1>

        <div class="grid grid-cols-3 gap-8 mb-12 border-y border-zinc-800 py-12 text-center">
          <div>
            <span class="block text-5xl font-black text-yellow-500 mb-2">{team.stats.titles}</span>
            <span class="text-sm text-zinc-400 uppercase font-bold tracking-[0.2em]">Titles</span>
          </div>
          <div class="border-x border-zinc-800">
            <span class="block text-5xl font-black text-white mb-2">{team.stats.wins}</span>
            <span class="text-sm text-zinc-400 uppercase font-bold tracking-[0.2em]">Wins</span>
          </div>
          <div>
            <span class="block text-5xl font-black text-white mb-2">{team.stats.podiums}</span>
            <span class="text-sm text-zinc-400 uppercase font-bold tracking-[0.2em]">Podiums</span>
          </div>
        </div>

        <p class="text-xl text-zinc-400 leading-relaxed italic whitespace-pre-line">{team.bio}</p>
      </div>

      <div class="relative aspect-square bg-zinc-900/30 rounded-[40px] border border-zinc-800 flex items-center justify-center overflow-hidden">
        <img 
          src={team.logo} 
          alt={team.name} 
          class="w-4/5 drop-shadow-2xl rounded-2xl object-contain" 
        />
      </div>
    </div><br>

    <section>
      <h2 class="text-3xl font-black italic uppercase mb-12 flex items-center gap-4">
        Driver Lineup
        <div class="h-px flex-1 bg-zinc-800"></div>
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {teamDrivers.map((driver) => (
          <a href={`/drivers/${driver.id}`} class="group bg-zinc-900 border border-zinc-800 rounded-2xl p-8 hover:border-white/20 transition-all">
            <div class="flex justify-between items-center">
              <div>
                <span class="text-sm font-bold text-zinc-500 uppercase tracking-widest">#{driver.number}</span>
                <h3 class="text-3xl font-black uppercase italic text-white group-hover:text-red-500 transition-colors">{driver.name}</h3>
              </div>
              <span class="text-4xl">{driver.flag}</span>
            </div>
            <div class="mt-6 aspect-video bg-zinc-950 rounded-lg overflow-hidden border border-zinc-800">
              <img src={driver.car} class="w-full h-full object-cover opacity-60 group-hover:opacity-100 transition-opacity duration-500" />
            </div>
          </a>
        ))}
      </div>
    </section>

  </main>
</Layout>